<html>
  <head>
    <title>Moonlight Clip Modification Test</title>
		<script type="text/javascript" src="../js/js/utils.js"></script>
		<script type="text/javascript" src="../js/js/testplugin.js"></script>

      <script language="javascript">
	var control;
 
	function OnLoaded(sender, eventArgs)
        {
                if (document.body == null || !TestPluginReady) {
                        setTimeout (function(){ OnLoaded(sender, eventArgs)}, 100);
                        return;
                }
	        
                setTimeout (function(){ RunTest(sender, eventArgs)}, 1000);
        }
	
        function RunTest (sender, eventArgs)
        {
	       var clip = sender.findName ("clipRect");
	       var clip2 = sender.findName ("clipRect2");
	       var xform = sender.findName ("xform");
	       //alert ("clip " + clip);
	       //alert ("rect: " + clip.Rect);
	       clip.rect = "0,0,100,100";
	       //alert ("set clip");
	       //alert ("clip.Rect = " + clip.Rect);
	       clip2.rect = "0,0,100,100";
	       TestHost.TranslateCoordinates = true;
		TakeSingleSnapshotAndShutdown ("", "test-clip-invalid-update.htm.png", 500, 500, 100);	
	       xform.x = "0";
        }

        function ErrorHandler (sender, args)
        {
	alert (args.ErrorMessage);
        }
      </script>
  </head>

<body scroll="no" style='border-width: 0px'>
    <div>
        <embed type="application/x-silverlight"
             width="500"
             height="500"
             id="_MoonlightControl" Source="test-clip-invalid-update.xaml" OnError="ErrorHandler" 
             style="position:absolute; left:0px; top:0px" >
        </embed>
    </div>
  </body>
</html>


