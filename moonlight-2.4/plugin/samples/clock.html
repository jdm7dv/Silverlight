<html>

<head>
	<title>Moonlight Clock Sample</title>
</head>

<body bgcolor="white" onload="StartClock()" onunload="StopClock()">

	<h2 align="center">Moon Clock Sample</h2>

	<p align="center">
		<object id="moonControl" width="300" height="225" type="application/x-silverlight">
			<param name="background" value="#ffebcd" />
			<param name="enableFramerateCounter" value="true" />
			<param name="enableHtmlAccess" value="true" />
			<param name="initParams" value="paramValue1, paramValue2" />
			<param name="maxFrameRate" value="30" />
			<param name="onError" value="myErrorHandler" />
			<param name="onLoad" value="onLoad" />
			<param name="source" value="clock.xaml" />
			<param name="windowless" value="false" />
		</object>
	</p>

    <script type="text/javascript">
		var control = null;
		var timerID = null;
		var image = null;
		var secondsHand = null;
		var minuteHand = null;
		var hourHand = null;

		function StartClock () {
			control = document.getElementById("moonControl");
			image = control.content.findName("backImage");
			secondsHand = control.content.findName("secondsHand");
			minuteHand = control.content.findName("minuteHand");
			hourHand = control.content.findName("hourHand");

			timerID = self.setTimeout("UpdateClock()", 1);
		}

		function StopClock () {
			if (timerID)
				clearTimeout (timerID)
		}

		function UpdateClock () {
			var date = new Date();

			if (date.getSeconds() < 30)
				image.source = "moon1.jpg";
			else
				image.source = "moon2.jpg";

			secondsHand.angle = (date.getSeconds () * 6);
			minuteHand.angle = (date.getMinutes () * 6);
			hourHand.angle = (date.getHours () * 30);

			self.setTimeout("UpdateClock()", 1000);
		}

		

    </script>

</body>
</html>
