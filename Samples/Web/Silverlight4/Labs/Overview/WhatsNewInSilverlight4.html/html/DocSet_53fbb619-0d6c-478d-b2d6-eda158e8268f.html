<html dir="ltr" xmlns:MSHelp="http://msdn.microsoft.com/mshelp" xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882" xmlns:xlink="http://www.w3.org/1999/xlink">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
    <meta name="save" content="history" />
    <xml>
      <MSHelp:TOCTitle Title="Moving Beyond the Browser – Sandboxed Applications" />
      <MSHelp:RLTitle Title="Moving Beyond the Browser – Sandboxed Applications" />
      <MSHelp:Attr Name="DocSet" Value="docSet" />
      <MSHelp:Attr Name="TopicType" Value="kbOrient" />
      <MSHelp:Attr Name="Locale" Value="kbEnglish" />
      <MSHelp:Attr Name="AssetId" Value="{GUID}" />
    </xml>
    <title>Moving Beyond the Browser – Sandboxed Applications</title>
    <link rel="stylesheet" type="text/css" href="../local/Classic.css" />
    <script src="../local/EventUtilities.js" type="text/javascript" language="jscript"> </script>
    <script src="../local/SplitScreen.js" type="text/javascript" language="jscript"> </script>
    <script src="../local/Dropdown.js" type="text/javascript" language="jscript"> </script>
    <script src="../local/script.js" type="text/javascript" language="jscript"> </script>
  </head>
  <body>
    <input type="hidden" id="userDataCache" class="userDataStyle" />
    <input type="hidden" id="hiddenScrollOffset" />
    <img id="dropDownImage" style="display:none; height:0; width:0;" alt="DropDown image" src="../local/drpdown.gif" />
    <img id="dropDownHoverImage" style="display:none; height:0; width:0;" alt="DropDownHover image" src="../local/drpdown_orange.gif" />
    <img id="collapseImage" style="display:none; height:0; width:0;" alt="Collapse image" src="../local/collapse_all.gif" />
    <img id="expandImage" style="display:none; height:0; width:0;" alt="Expand image" src="../local/expand_all.gif" />
    <img id="collapseAllImage" style="display:none; height:0; width:0;" alt="CollapseAll image" src="../local/collall.gif" />
    <img id="expandAllImage" style="display:none; height:0; width:0;" alt="ExpandAll image" src="../local/expall.gif" />
    <img id="copyImage" style="display:none; height:0; width:0;" alt="Copy image" src="../local/copycode.gif" />
    <img id="copyHoverImage" style="display:none; height:0; width:0;" alt="CopyHover image" src="../local/copycodeHighlight.gif" />
    <div id="header">
      <table width="100%" id="topTable">
        <tr id="headerTableRow1">
          <td align="left">
            <span id="runningHeaderText">Silverlight Overview - Technical Whitepaper</span>
          </td>
        </tr>
        <tr id="headerTableRow2">
          <td align="left">
            <span id="nsrTitle">Moving Beyond the Browser – Sandboxed Applications</span>
          </td>
        </tr>
        <tr id="headerTableRow3">
          <td />
        </tr>
      </table>
      <table width="100%" id="bottomTable" cellspacing="0" cellpadding="0">
        <tr>
          <td>
            <span onclick="ExpandCollapseAll(toggleAllImage)" onkeypress="ExpandCollapseAll_CheckKey(toggleAllImage)" tabindex="0" style="cursor:default;display:none;">
              <img id="toggleAllImage" class="toggleAll" alt="CollapseAll image" src="../local/collall.gif" />
              <label id="collapseAllLabel" for="toggleAllImage" style="display: none;">Collapse All</label>
              <label id="expandAllLabel" for="toggleAllImage" style="display: none;">Expand All</label> </span>
            <span id="languageFilterToolTip" onmouseover="languageFilterImage.src=dropDownHoverImage.src;" onmouseout="languageFilterImage.src=dropDownImage.src;" tabindex="0" style="cursor:default;">
              <img id="languageFilterImage" alt="DropDown image" src="../local/drpdown.gif" />
              <label id="showAllLabel" for="languageFilterImage" style="display: none;">Language Filter: All</label>
              <label id="multipleLabel" for="languageFilterImage" style="display: none;">Language Filter: Multiple</label>
              <label id="vbLabel" for="languageFilterImage" style="display: none;">Language Filter: Visual Basic</label>
              <label id="csLabel" for="languageFilterImage" style="display: none;">Language Filter: C#</label>
            </span>
          </td>
        </tr>
      </table>
      <div id="languageSpan">
        <input type="checkbox" name="languageFilter" onclick="SetLanguage(this)" id="vbUsageCheckbox" />
        <label class="languageFilter" for="vbUsageCheckbox">Visual Basic Usage</label>
        <br />
        <input type="checkbox" name="languageFilter" onclick="SetLanguage(this)" id="csCheckbox" />
        <label class="languageFilter" for="csCheckbox">C#</label>
        <br />
      </div>
    </div>
    <div id="mainSection">
      <div id="mainBody">
        <div id="allHistory" class="saveHistory" onsave="saveAll()" onload="loadAll()" />
        <a name="_Toc256192951" href="#">
          <span />
        </a>
        <p>
          <b>Out-of-Browser Windowing Updates</b>
        </p>
        <p>Silverlight 4 has some new Out-of-Browser features including the ability to resize the window programmatically, position the window to start up anywhere on the screen, and set the window’s z-order. You can also set the window state to maximized or minimized.</p>
        <a name="_Toc256192952" href="#">
          <span />
        </a>
        <p>
          <b>Hosting Web Content within Silverlight Applications</b>
        </p>
        <p>The WebBrowser control allows you to display HTML in the control when running Out-of-Browser. When you use a WebBrowser control in an application that runs inside a browser, a rectangle the same size as the WebBrowser control will display instead of the WebBrowser and its content. There are three ways to load web content inside of the WebBrowser control:</p>
        <ol>
          <li>The NavigateToString method</li>
          <li>The Navigate method</li>
          <li>The Source property</li>
        </ol>
        <p>The NavigateToString method accepts a string that represents content (HTML and JavaScript). The content is passed to this method is rendered in the WebBrowser control. The Navigate method accepts a URI that points to the HTML content that you want to render. The URI does not need to be in the same domain as the Silverlight application. The Source property is another way to set the content to a URI. </p>
        <p>The following code loads the WebBrowser control <b>wb</b> with HTML content when run Out-of-Browser.</p>
        <div class="code">
          <span codeLanguage="CSharp">
            <table width="100%" cellspacing="0" cellpadding="0">
              <tr>
                <th>C#</th>
                <th>
                  <span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0">
                    <img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span>
                </th>
              </tr>
              <tr>
                <td colspan="2">
                  <pre>string content = "&lt;table border=3 cellpadding=3&gt;&lt;tr&gt;&lt;td&gt;&lt;font size=36" +          "color='red'&gt;Red&lt;/font&gt;&lt;/td&gt;&lt;td&gt;&lt;font size=36" +         "color='blue'&gt;Blue&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;";wb.NavigateToString(content)</pre>
                </td>
              </tr>
            </table>
          </span>
        </div>
        <p>
          <img src="images\038d4650-fa24-47ae-a652-aa8c0e7f24d1.png" />
        </p>
        <p>
          <b>Figure 21</b>
          <br />
          <i>Embedded Web Content</i>
        </p>
        <p>The following code loads the www.microsoft.com Web page in the WebBrowser control when run Out-of-Browser.</p>
        <div class="code">
          <span codeLanguage="CSharp">
            <table width="100%" cellspacing="0" cellpadding="0">
              <tr>
                <th>C#</th>
                <th>
                  <span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0">
                    <img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span>
                </th>
              </tr>
              <tr>
                <td colspan="2">
                  <pre>wb.Navigate(new Uri("http://www.microsoft.com"));</pre>
                </td>
              </tr>
            </table>
          </span>
        </div>
        <p>
          <img src="images\9bfb9947-5f0a-47fb-9ea5-0514150fb977.png" />
        </p>
        <p>
          <b>Figure 22</b>
          <br />
          <i>Loading www.microsoft.com in a WebBrowser Control</i>
        </p>
        <a name="_Toc256192953" href="#">
          <span />
        </a>
        <p>
          <b>WebBrowserBrush</b>
        </p>
        <p>Silverlight adds a new type of brush called an WebBrowserBrush that accepts a WebBrowser control as its source. The SetSource method accepts a WebBrowser control and displays the content using the WebBrowserBrush in another UI Element. The WebBrowserBrush is a brush which means it is non-interactive HTML. For example, a Path, Ellipse, or Rectangle can be painted using the WebBrowserBrush, which gets its source from the www.Microsoft.com Web page. The XAML below defines a Path with an WebBrowserBrush.</p>
        <div class="code">
          <span codeLanguage="other">
            <table width="100%" cellspacing="0" cellpadding="0">
              <tr>
                <th>XAML</th>
                <th>
                  <span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0">
                    <img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span>
                </th>
              </tr>
              <tr>
                <td colspan="2">
                  <pre>&lt;Path Data="M0.5,0.5 L68.247093,0.5 L67.29586,1.0469482 C60.223965,5.343935 55.5,13.120297 55.5,22.000002 C55.5,35.530975 66.469025,46.5 80,46.5 C93.530975,46.5 104.5,35.530975 104.5,22.000002 C104.5,13.120297 99.776031,5.343935 92.70414,1.0469482 L91.752907,0.5 L159.5,0.5 L159.5,57.298336 L159.91597,56.378239 C163.87273,48.166615 172.27461,42.5 182,42.5 C195.53098,42.5 206.5,53.469025 206.5,67 C206.5,80.530975 195.53098,91.5 182,91.5 C172.27461,91.5 163.87273,85.833389 159.91597,77.621765 L159.5,76.70166 L159.5,133.5 L89.70166,133.5 L90.621765,133.91597 C98.833389,137.87274 104.5,146.27461 104.5,156 C104.5,169.53098 93.530975,180.5 80,180.5 C66.469025,180.5 55.5,169.53098 55.5,156 C55.5,146.27461 61.166618,137.87274 69.378235,133.91597 L70.298332,133.5 L0.5,133.5 L0.5,78.752907 L1.0469483,79.70414 C5.343935,86.776031 13.120296,91.5 22.000002,91.5 C35.530975,91.5 46.5,80.530975 46.5,67 C46.5,53.469025 35.530975,42.5 22.000002,42.5 C13.120296,42.5 5.343935,47.223965 1.0469483,54.29586 L0.5,55.247093 z"         Stroke="#FF666666" Stretch="Fill" StrokeThickness="0.5"         StrokeLineJoin="Round"&gt;    &lt;Path.Fill&gt;        &lt;WebBrowserBrush x:Name="WebBrowserBrush"                 AlignmentX="Left" AlignmentY="Top" Stretch="None"/&gt;    &lt;/Path.Fill&gt;&lt;/Path&gt;</pre>
                </td>
              </tr>
            </table>
          </span>
        </div>
        <p>You can set the WebBrowserBrush to a WebBrowser control that loads the www.microsoft.com Web page, as shown in the code below.</p>
        <div class="code">
          <span codeLanguage="CSharp">
            <table width="100%" cellspacing="0" cellpadding="0">
              <tr>
                <th>C#</th>
                <th>
                  <span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0">
                    <img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span>
                </th>
              </tr>
              <tr>
                <td colspan="2">
                  <pre>wbBrush.SetSource(wb);</pre>
                </td>
              </tr>
            </table>
          </span>
        </div>
        <p>
          <img src="images\99df8a81-f89f-42ed-8af5-23fc983b5af5.png" />
        </p>
        <p>
          <b>Figure 23</b>
          <br />
          <i>Painting a Path with an WebBrowserBrush</i>
        </p>
        <a name="_Toc256192954" href="#">
          <span />
        </a>
        <p>
          <b>Notifications (Toast)</b>
        </p>
        <p>Now Silverlight’s Out-of-Browser applications can use the NotificationWindow class to display notifications (also known as toasts). Notifications let you alert the user that a significant event has occurred in the Out-of-Browser application. You can create a new instance of the NotificationWindow, set its height and width, then set its Content property to some XAML content. Finally, to display the notification window, invoke the Show method and pass to it the number of milliseconds it should be displayed, as shown in the sample code below.</p>
        <div class="code">
          <span codeLanguage="CSharp">
            <table width="100%" cellspacing="0" cellpadding="0">
              <tr>
                <th>C#</th>
                <th>
                  <span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0">
                    <img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span>
                </th>
              </tr>
              <tr>
                <td colspan="2">
                  <pre>NotificationWindow notify = new NotificationWindow();notify.Width = 330;notify.Height = 75;TextBlock tb = new TextBlock();tb.Text = "Sample notification";tb.FontSize = 24;notify.Content = tb;notify.Show(3000);</pre>
                </td>
              </tr>
            </table>
          </span>
        </div>
        <p>The previous code shows a simple example that displays a basic notification. However, you can also customize the content for a notification to look any way you want. The image below shows a customized notification.</p>
        <p>
          <img src="images\8d85793a-43a4-44f0-8925-4fb26a36fcac.png" />
        </p>
        <p>
          <b>Figure 24</b>
          <br />
          <i>Custom Notification</i>
        </p>
        <a name="_Toc256192955" href="#">
          <span />
        </a>
        <p>
          <b>Window Closing Event</b>
        </p>
        <p>Silverlight 4 adds the ability to discover when an out of browser application’s window is being closed. The Closing event offers the opportunity to cancel this operation (unless it is being closed due to the user shutting down or logging off from the system).  The following code could be added to handle the Closing event.</p>
        <div class="code">
          <span codeLanguage="CSharp">
            <table width="100%" cellspacing="0" cellpadding="0">
              <tr>
                <th>C#</th>
                <th>
                  <span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0">
                    <img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span>
                </th>
              </tr>
              <tr>
                <td colspan="2">
                  <pre>Window mainWindow = Application.Current.MainWindow;void SomeMethod(){    if (Application.Current.IsRunningOutOfBrowser)    {        mainWindow.Closing += MainWindow_Closing;    }}</pre>
                </td>
              </tr>
            </table>
          </span>
        </div>
        <p>The handler for the Closing event (shown below) checks if a CheckBox named canCloseCheckBox is checked. If so and the application is being closed by the user (not by a user shut down or logging off the system), the window is then closed.</p>
        <div class="code">
          <span codeLanguage="CSharp">
            <table width="100%" cellspacing="0" cellpadding="0">
              <tr>
                <th>C#</th>
                <th>
                  <span class="copyCode" onclick="CopyCode(this)" onkeypress="CopyCode_CheckKey(this)" onmouseover="ChangeCopyCodeIcon(this)" onfocusin="ChangeCopyCodeIcon(this)" onmouseout="ChangeCopyCodeIcon(this)" onfocusout="ChangeCopyCodeIcon(this)" tabindex="0">
                    <img class="copyCodeImage" name="ccImage" align="absmiddle" src="../local/copycode.gif" />Copy Code
                  </span>
                </th>
              </tr>
              <tr>
                <td colspan="2">
                  <pre>void MainWindow_Closing(object sender,    System.ComponentModel.ClosingEventArgs e){    if (canCloseCheckBox.IsChecked == false &amp;&amp;        e.IsCancelable)    {        e.Cancel = true;    }}</pre>
                </td>
              </tr>
            </table>
          </span>
        </div>
        <br />
      </div>
      <div id="footer">
        <div class="footerLine">
          <img src="../local/footer.gif" alt="Footer image" width="100%" height="3px" />
        </div>To give feedback please write to jopapa@microsoft.com<p />Copyright © 2010 by Microsoft Corporation. All rights reserved.</div>
    </div>
  </body>
</html>